<!DOCTYPE html>
<html>
<body>
    <h2>Upload PDF</h2>
    <input type="file" id="fileInput" />
    <button onclick="uploadPDF()">Process</button>

    <pre id="output"></pre>

<script>
async function uploadPDF() {
    const file = document.getElementById("fileInput").files[0];
    if (!file) return alert("Choose a file first!");

    // Convert PDF â†’ base64 safely using FileReader
    const base64String = await new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => {
            const base64 = reader.result.split(",")[1]; // remove prefix
            resolve(base64);
        };
        reader.onerror = reject;
        reader.readAsDataURL(file);
    });

    const res = await fetch("/api/extract_text", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ file: base64String })
    });

    const data = await res.json();
    document.getElementById("output").textContent = data.text || data.error;
}
</script>

</body>
</html>
